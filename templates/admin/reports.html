{% extends "base.html" %}

{% block content %}
<div class="space-y-6">
  <div class="flex items-center justify-between">
    <h1 class="text-2xl font-semibold">Жалобы</h1>
    <div class="flex gap-2">
      <a href="{{ url_for('admin_reports', status='pending') }}" class="px-3 py-1 text-sm {% if status == 'pending' %}bg-zinc-900 text-white{% else %}bg-zinc-100{% endif %} rounded">Ожидающие</a>
      <a href="{{ url_for('admin_reports', status='resolved') }}" class="px-3 py-1 text-sm {% if status == 'resolved' %}bg-zinc-900 text-white{% else %}bg-zinc-100{% endif %} rounded">Решённые</a>
      <a href="{{ url_for('admin_reports', status='all') }}" class="px-3 py-1 text-sm {% if status == 'all' %}bg-zinc-900 text-white{% else %}bg-zinc-100{% endif %} rounded">Все</a>
    </div>
  </div>

  {% if reports %}
    <div class="space-y-4">
      {% for report in reports %}
        <div class="p-4 bg-zinc-50 rounded-lg">
          <div class="flex items-start justify-between">
            <div>
              <span class="px-2 py-1 text-xs {% if report.status == 'pending' %}bg-yellow-100 text-yellow-800{% elif report.status == 'resolved' %}bg-green-100 text-green-800{% else %}bg-gray-100 text-gray-800{% endif %} rounded">
                {{ {'pending': 'Ожидает', 'resolved': 'Решена', 'dismissed': 'Отклонена'}[report.status] }}
              </span>
              <p class="mt-2 text-sm text-zinc-600">
                От: <a href="{{ url_for('profile', username=report.reporter.username if report.reporter else 'unknown') }}" class="hover:underline">
                  {{ report.reporter.display_name if report.reporter else 'Unknown' }}
                </a>
              </p>
              <p class="mt-1 text-sm text-zinc-500">
                Тип: {{ report.content_type }} | ID: {{ report.content_id }}
              </p>
              <p class="mt-2">{{ report.reason }}</p>
              {% if report.content %}
                <div class="mt-3 p-3 bg-white rounded border border-zinc-200">
                  {% if report.content_type == 'post' %}
                    <p class="text-sm truncate">{{ report.content.content }}</p>
                  {% else %}
                    <p class="text-sm">{{ report.content.content }}</p>
                  {% endif %}
                </div>
              {% endif %}
            </div>
            <div class="flex gap-2">
              {% if report.status == 'pending' %}
                <a href="{{ url_for('admin_view_report', report_id=report.id) }}" class="px-3 py-1 bg-zinc-900 text-white text-sm rounded hover:bg-zinc-700">Рассмотреть</a>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-zinc-500">Нет жалоб</p>
  {% endif %}
</div>
{% endblock %}
