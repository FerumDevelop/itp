{% extends "base.html" %}

{% block content %}
<h1 class="text-2xl font-semibold mb-6">Настройки</h1>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
  <div>
    <h2 class="text-xl font-semibold mb-4">Профиль</h2>
    
    <form method="POST" action="{{ url_for('settings') }}" class="space-y-4">
      <input type="hidden" name="action" value="update_profile">
      
      <div>
        <label class="block text-sm text-zinc-600 mb-1">Отображаемое имя</label>
        <input type="text" name="display_name" value="{{ current_user.display_name }}"
          class="w-full p-2 border border-zinc-300 rounded focus:outline-none focus:border-zinc-900">
      </div>
      
      <div>
        <label class="block text-sm text-zinc-600 mb-1">Bio</label>
        <textarea name="bio" rows="4" placeholder="Расскажите о себе..."
          class="w-full p-2 border border-zinc-300 rounded focus:outline-none focus:border-zinc-900">{{ current_user.bio }}</textarea>
      </div>
      
      <button type="submit" class="px-4 py-2 bg-zinc-900 text-white hover:bg-zinc-700 transition-colors">Сохранить</button>
    </form>
    
    <div class="mt-6">
      <h3 class="text-lg font-medium mb-2">Аватар</h3>
      <img src="{{ url_for('uploaded_file', filename=current_user.avatar) }}" alt="Avatar" 
        class="w-20 h-20 rounded-full object-cover bg-zinc-100 mb-3">
      <form action="{{ url_for('upload_avatar') }}" method="POST" enctype="multipart/form-data">
        <input type="file" name="avatar" accept="image/*" class="mb-2 text-sm">
        <button type="submit" class="px-3 py-1 bg-zinc-100 text-sm border border-zinc-300 rounded hover:bg-zinc-50">Загрузить</button>
      </form>
    </div>
    
    <div class="mt-6">
      <h3 class="text-lg font-medium mb-2">Баннер</h3>
      {% if current_user.banner and current_user.banner != 'default_banner.png' %}
        <img src="{{ url_for('uploaded_file', filename=current_user.banner) }}" alt="Banner" 
          class="w-full h-24 object-cover rounded bg-zinc-100 mb-3">
      {% endif %}
      <form action="{{ url_for('upload_banner') }}" method="POST" enctype="multipart/form-data">
        <input type="file" name="banner" accept="image/*" class="mb-2 text-sm">
        <button type="submit" class="px-3 py-1 bg-zinc-100 text-sm border border-zinc-300 rounded hover:bg-zinc-50">Загрузить</button>
      </form>
    </div>
  </div>
  
  <div>
    <h2 class="text-xl font-semibold mb-4">Безопасность</h2>
    
    <form method="POST" action="{{ url_for('settings') }}" class="space-y-4">
      <input type="hidden" name="action" value="update_password">
      
      <div>
        <label class="block text-sm text-zinc-600 mb-1">Текущий пароль</label>
        <input type="password" name="current_password" placeholder="Введите текущий пароль"
          class="w-full p-2 border border-zinc-300 rounded focus:outline-none focus:border-zinc-900" required>
      </div>
      
      <div>
        <label class="block text-sm text-zinc-600 mb-1">Новый пароль</label>
        <input type="password" name="new_password" placeholder="Минимум 8 символов"
          class="w-full p-2 border border-zinc-300 rounded focus:outline-none focus:border-zinc-900" required>
      </div>
      
      <button type="submit" class="px-4 py-2 bg-zinc-900 text-white hover:bg-zinc-700 transition-colors">Изменить пароль</button>
    </form>
    
    <div class="mt-8 border-t border-zinc-200 pt-6">
      <h2 class="text-xl font-semibold mb-4">Верификация</h2>
      
      {% if current_user.is_verified %}
        <p class="text-green-600 flex items-center gap-2">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
          </svg>
          Ваш аккаунт верифицирован
        </p>
      {% else %}
        <p class="text-zinc-600 mb-3">Получите галочку для своего аккаунта</p>
        <a href="{{ url_for('apply_verification') }}" class="inline-block px-4 py-2 bg-zinc-900 text-white hover:bg-zinc-700 transition-colors">
          Подать заявку
        </a>
      {% endif %}
    </div>
    
    <div class="mt-8 border-t border-zinc-200 pt-6">
      <h2 class="text-xl font-semibold mb-4 text-red-600">Опасная зона</h2>
      
      <form action="{{ url_for('delete_account') }}" method="POST" onsubmit="return confirm('Вы уверены? Это действие нельзя отменить!')">
        <div class="mb-4">
          <label class="block text-sm text-zinc-600 mb-1">Введите пароль для подтверждения</label>
          <input type="password" name="password" placeholder="Ваш пароль"
            class="w-full p-2 border border-zinc-300 rounded focus:outline-none focus:border-red-500" required>
        </div>
        <button type="submit" class="px-4 py-2 bg-red-600 text-white hover:bg-red-700 transition-colors">Удалить аккаунт</button>
      </form>
    </div>
  </div>
</div>
{% endblock %}
